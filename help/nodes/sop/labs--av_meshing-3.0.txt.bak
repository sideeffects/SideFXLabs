= Labs AV Meshing =

#type: node
#context: sop
#internal: labs::av_meshing::3.0
#icon: alicevision.png
#tags: sidefxlabs,  photogrammetry

"""  Creates a dense geometric surface representation of the scene using Alicevision. """

The objective of this step is to create a dense geometric surface representation of the scene. The output of this node is a high-poly mesh, which can be used for any further processing in Houdini.

@parameters
    == Main ==
    Cook:
        Start the cooking process for this step.
    Manual Mode:
        This toggle controls if the node should automatically recook if any dependencies have changed.
    Use Log:
        This toggle controls if the status of the current node should be printed to the console. This is useful for getting a quick overview of the progress.
    == Meshing ==
    Max Input Points:
        Max input points loaded from depth map images.
    Max Points:
        Max points at the end of the depth maps fusion.
    Max Points per Voxel:
        Max points per voxel.
    Min Step:
        The step used to load depth values from depth maps is computed from maxInputPts. Here we define the minimal value for this step, so on small datasets we will not spend too much time at the beginning loading all depth values.
    Vertex Colors:
        Whether to colorize output dense point cloud and mesh.
    Partitioning:
        Enable Partitioning.
    Repartition:
        Enable Repartitioning.
    Angle Factor:
        AngleFactor.
    Sim Factor:
        Sim Factor.
    pixSizeMarginInitCoef:
        pixSizeMarginInitCoef.
    pixSizeMarginFinalCoef:
        pixSizeMarginFinalCoef.
    voteMarginFactor:
        voteMarginFactor.
    contributeMarginFactor:
        contributeMarginFactor.
    simGaussianSizeInit:
        simGaussianSizeInit.
    simGaussianSize:
        simGaussianSize.
    minAngleThreshold:
        minAngleThreshold.
    Refine Fuse:
        Refine depth map fusion with the new pixels size defined by angle and similarity scores.
    Estimate Space From SfM:
        Estimate the 3d space from the SfM.
    Min Observations For SfM Space Estimation:
        Minimum number of observations for SfM space estimation.
    Min Observations Angle For SfM Space Estimation:
        Minimum angle between two observations for SfM space estimation.
    Add Landmarks To The Dense Point Cloud:
        Add SfM Landmarks to the dense point cloud.
    == Mesh Filter ==
    Filter Large Triangles Factor:
        Remove all large triangles. We consider a triangle as large if one edge is bigger than N times the average edge length. Put zero to disable it.
    Keep Only the Largest Mesh:
        Keep only the largest connected triangles group.
    Num of Iterations:
        Number of smoothing iterations.
    Lambda:
        Lambda.

@outputs
AV Depth Map:
    This plugs into AV Texturing, and holds the generated mesh.
Pointcloud:
    This is the pointcloud generated by the meshing step.